<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EctorDB 3D ë²¡í„° ê³µê°„ ì‹œê°í™” (ê°€ìƒ ë²¡í„°)</title>
    <!-- Tailwind CSS ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- three.js (3D ë¼ì´ë¸ŒëŸ¬ë¦¬) ë¡œë“œ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- importmap: three.js ì• ë“œì˜¨(OrbitControls, CSS2DRenderer) ë¡œë“œ -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.128.0/examples/jsm/"
            }
        }
    </script>

    <style>
        body {
            font-family: 'Inter', 'Noto Sans KR', sans-serif;
            overscroll-behavior: none;
        }
        #canvas-container {
            width: 100%;
            height: 60vh;
            position: relative;
            background-color: #0c0c14;
        }
        canvas {
            display: block;
        }
        #label-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        /* í´ëŸ¬ìŠ¤í„° ë¼ë²¨ ìŠ¤íƒ€ì¼ */
        .label {
            color: #fff;
            background: rgba(0, 0, 0, 0.6);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 14px;
            text-shadow: 0 0 4px black;
            pointer-events: auto; /* ë¼ë²¨ì€ í´ë¦­ ê°€ëŠ¥ */
            cursor: pointer;
            border: 1px solid #4ade80; /* í´ë¦­ ê°€ëŠ¥í•¨ì„ ë…¹ìƒ‰ í…Œë‘ë¦¬ë¡œ í‘œì‹œ */
            transition: all 0.2s ease-in-out;
        }
        .label:hover {
            background-color: #4ade80;
            color: #000;
            transform: scale(1.1);
            border-color: #fff;
        }
        /* ëª¨ë‹¬ íŒì—… ìŠ¤íƒ€ì¼ */
        #modal {
            transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;
        }
        #modal.hidden { opacity: 0; visibility: hidden; }
        #modal.visible { opacity: 1; visibility: visible; }

        /* ì›ë³¸ í…ìŠ¤íŠ¸ <pre> ìŠ¤íƒ€ì¼ */
        #modal-source-text {
            background-color: #1a1a2e;
            color: #e0e0e0;
            padding: 12px;
            border-radius: 6px;
            max-height: 150px;
            overflow-y: auto;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        /* === 768ì°¨ì› ê°€ìƒ ì‹œê°í™” ìŠ¤íƒ€ì¼ === */
        #modal-vector-snippet {
            background-color: #1a1a2e;
            color: #a0a0ff;
            padding: 8px 12px;
            border-radius: 4px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            white-space: pre;
            overflow-x: auto;
        }

        #modal-vector-visual {
            display: flex;
            align-items: flex-end; /* ë§‰ëŒ€ê°€ ì•„ë˜ì—ì„œ ìë¼ë„ë¡ */
            height: 100px;
            width: 100%;
            background-color: #1a1a2e;
            border: 1px solid #333;
            border-radius: 4px;
            overflow: hidden;
            padding: 2px;
            gap: 1px; /* ë§‰ëŒ€ ì‚¬ì´ ê°„ê²© */
        }
        .vector-bar {
            flex-grow: 1; /* ëª¨ë“  ë§‰ëŒ€ê°€ ë™ì¼í•œ ë„ˆë¹„ë¥¼ ê°–ë„ë¡ */
            width: 1px; /* ë„ˆë¹„ëŠ” flex-growë¡œ ì¡°ì ˆë¨ */
            /* JSì—ì„œ ë†’ì´ì™€ ë°°ê²½ìƒ‰ ì„¤ì • */
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">

    <div class="container mx-auto p-4 md:p-8">
        <h1 class="text-2xl md:text-3xl font-bold mb-4 text-center text-blue-300">
            EctorDB ë°ì´í„° êµ¬ì¡°: 3ì°¨ì› ì˜ë¯¸ ê³µê°„(Semantic Space)
        </h1>
        <p class="text-center text-gray-400 mb-6">
            <strong class="text-yellow-300">ì—…ë°ì´íŠ¸:</strong> 3D ê³µê°„ì˜ <strong class="text-green-300">ë…¹ìƒ‰ í…Œë‘ë¦¬ ë¼ë²¨</strong>ì„ í´ë¦­í•˜ë©´ 'ê°€ìƒ ë²¡í„°'ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.
            <br>
            (ë“œë˜ê·¸: íšŒì „ / íœ : í™•ëŒ€ / ìš°í´ë¦­: ì´ë™)
        </p>

        <!-- 3D ìº”ë²„ìŠ¤ & ë¼ë²¨ ì»¨í…Œì´ë„ˆ -->
        <div id="canvas-container" class="rounded-lg overflow-hidden shadow-2xl">
            <div id="label-container"></div>
        </div>

        <!-- ë²”ë¡€ -->
        <div class="flex flex-wrap justify-center gap-4 md:gap-6 my-6">
            <div class="flex items-center"><span class="w-4 h-4 rounded-full bg-blue-500 mr-2 border border-blue-300"></span><span class="text-sm">ğŸ”µ V_ëª…ì¹­</span></div>
            <div class="flex items-center"><span class="w-4 h-4 rounded-full bg-green-500 mr-2 border border-green-300"></span><span class="text-sm">ğŸŸ¢ V_ìš”ì•½</span></div>
            <div class="flex items-center"><span class="w-4 h-4 rounded-full bg-red-500 mr-2 border border-red-300"></span><span class="text-sm">ğŸ”´ V_ì²­êµ¬í•­</span></div>
            <div class="flex items-center"><span class="w-4 h-4 rounded-full bg-yellow-500 mr-2 border border-yellow-300"></span><span class="text-sm">ğŸŸ¡ V_AIìš”ì•½</span></div>
        </div>

        <!-- ì„¤ëª… íŒ¨ë„ -->
        <div class="bg-gray-800 p-6 md:p-8 rounded-lg shadow-xl mt-8">
            <h2 class="text-xl font-bold mb-4 border-b border-gray-600 pb-2">ğŸ” ì´ ê·¸ë¦¼ì˜ ì˜ë¯¸</h2>
            <div class="space-y-4 text-gray-300">
                <p>
                    <strong class="text-blue-300">1. ì „ì²´ ê³µê°„ (The 3D Box):</strong>
                    ì´ 3D ê³µê°„ì€ ì‹¤ì œë¡œëŠ” 768ì°¨ì›ì˜ <strong class="text-white">'ì˜ë¯¸ ê³µê°„(Semantic Space)'</strong>ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. 'ë¹„ìŠ·í•œ ì˜ë¯¸'ë¥¼ ê°€ì§„ ë¬¸ì¥ì¼ìˆ˜ë¡ ì´ ê³µê°„ì—ì„œ 'ê°€ê¹Œìš´' ìœ„ì¹˜ì— ì ìœ¼ë¡œ ì°í™ë‹ˆë‹¤.
                </p>
                <div>
                    <strong class="text-blue-300">2. íŠ¹í—ˆ 1ê±´ = 4ê°œì˜ ì  (Cluster):</strong>
                    <ul class="list-disc list-inside ml-4 mt-2 space-y-1">
                        <li>í•˜ë‚˜ì˜ íŠ¹í—ˆëŠ” 4ê°œ í•„ë“œ(ëª…ì¹­, ìš”ì•½, ì²­êµ¬í•­, AIìš”ì•½)ê°€ <strong class="text-white">ê°ê° ë³„ë„ì˜ 768ì°¨ì› ë²¡í„°(ì )</strong>ë¡œ ë³€í™˜ë˜ì—ˆê¸° ë•Œë¬¸ì—, ì´ 4ê°œì˜ ì ìœ¼ë¡œ í‘œí˜„ë©ë‹ˆë‹¤.</li>
                        <li><strong class="text-white">"íŠ¹í—ˆ A (EV ë°°í„°ë¦¬ ì¼€ì´ìŠ¤)"</strong>ì˜ 4ê°œ ì (ğŸ”µğŸŸ¢ğŸ”´ğŸŸ¡)ì€ ëª¨ë‘ 'EV ë°°í„°ë¦¬'ë¼ëŠ” ë™ì¼í•œ ì£¼ì œë¥¼ ë‹¤ë£¨ê¸° ë•Œë¬¸ì—, ì´ 768ì°¨ì› ê³µê°„ì—ì„œ ì„œë¡œ ë§¤ìš° ê°€ê¹Œìš´ ìœ„ì¹˜ì— ëª¨ì—¬ 'í•˜ë‚˜ì˜ ì„±ìš´(í´ëŸ¬ìŠ¤í„°)'ì„ í˜•ì„±í•©ë‹ˆë‹¤.</li>
                    </ul>
                </div>
                
                <!-- === ìˆ˜ì •ëœ ì„¤ëª… === -->
                <div>
                    <strong class="text-blue-300">3. ê°€ìƒ ë²¡í„° ë¶„ì„ (ì˜ë¯¸ ì§€ë¬¸):</strong>
                    <ul class="list-disc list-inside ml-4 mt-2 space-y-1">
                        <li>3D ê³µê°„ì˜ <strong class="text-green-300">ë…¹ìƒ‰ ë¼ë²¨</strong>ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ í´ëŸ¬ìŠ¤í„°ì˜ ìƒì„¸ ì •ë³´ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</li>
                        <li>EctorDBëŠ” ì›ë³¸ í…ìŠ¤íŠ¸ë¥¼ <strong class="text-white">768ì°¨ì›ì˜ ë³µì¡í•œ ìˆ«ì ë°°ì—´(ë²¡í„°)</strong>ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥í•©ë‹ˆë‹¤. ì´ ë²¡í„°ê°€ ë°”ë¡œ 'ì˜ë¯¸'ì˜ ì¢Œí‘œì…ë‹ˆë‹¤.</li>
                        <li>íŒì—…ì˜ <strong class="text-white">'ê°€ìƒ ì‹œê°í™”'</strong>ëŠ” ì´ 768ê°œ ì°¨ì›ì˜ ë³µì¡í•œ êµ¬ì¡°ë¥¼ 'ì˜ë¯¸ ì§€ë¬¸(Semantic Fingerprint)'ì²˜ëŸ¼ ì‹œê°í™”í•œ ê²ƒì…ë‹ˆë‹¤.</li>
                        <li><strong class="text-white">ìœ ì‚¬í•œ íŠ¹í—ˆ(ì˜ˆ: íŠ¹í—ˆ Aì™€ A-1)ëŠ” ì´ 'ì˜ë¯¸ ì§€ë¬¸'ì˜ íŒ¨í„´ì´ ì„œë¡œ ìœ ì‚¬í•©ë‹ˆë‹¤.</strong></li>
                    </ul>
                </div>
                <!-- === ì„¤ëª… ì¢…ë£Œ === -->

                <p>
                    <strong class="text-blue-300">4. ì„œë¡œ ë‹¤ë¥¸ íŠ¹í—ˆ (Far Apart):</strong>
                    <strong class="text-white">"íŠ¹í—ˆ B (LNG í™”ë¬¼ì°½)"</strong> í´ëŸ¬ìŠ¤í„°ëŠ” <strong class="text-white">"íŠ¹í—ˆ A (EV ë°°í„°ë¦¬)"</strong> í´ëŸ¬ìŠ¤í„°ì™€ëŠ” ì£¼ì œ(ì˜ë¯¸)ê°€ ì™„ì „íˆ ë‹¤ë¥´ê¸° ë•Œë¬¸ì—, ì´ ê³µê°„ì—ì„œ ì•„ì£¼ ë©€ë¦¬ ë–¨ì–´ì§„ ê³³ì— ìœ„ì¹˜í•˜ê²Œ ë©ë‹ˆë‹¤. (Bì˜ 'ì˜ë¯¸ ì§€ë¬¸'ì€ Aì™€ ì™„ì „íˆ ë‹¤ë¥¼ ê²ƒì…ë‹ˆë‹¤)
                </p>
                <div>
                    <strong class="text-yellow-300">5. ì˜ë¯¸ì  ìœ ì‚¬ì„± (Semantic Similarity):</strong>
                    <ul class="list-disc list-inside ml-4 mt-2 space-y-1">
                        <li><strong class="text-white">"íŠ¹í—ˆ A-1 (EV ë°°í„°ë¦¬ ê²½ëŸ‰í™”)"</strong>ëŠ” <strong class="text-white">"íŠ¹í—ˆ A (EV ë°°í„°ë¦¬ ì¼€ì´ìŠ¤)"</strong>ì™€ ë§¤ìš° ê°€ê¹Œìš´ ìœ„ì¹˜ì— ìˆìŠµë‹ˆë‹¤.</li>
                        <li>ì´ëŠ” ë‘ íŠ¹í—ˆê°€ 'EV ë°°í„°ë¦¬'ë¼ëŠ” í•µì‹¬ ì£¼ì œë¥¼ ê³µìœ í•˜ë©° 'ì˜ë¯¸ ì§€ë¬¸'ì´ ìœ ì‚¬í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- í´ëŸ¬ìŠ¤í„° ë¶„ì„ ëª¨ë‹¬ (Modal) -->
    <div id="modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="bg-gray-700 rounded-lg shadow-xl p-6 md:p-8 w-full max-w-2xl">
            <h3 id="modal-title" class="text-2xl font-bold text-green-300 mb-4"></h3>
            
            <h4 class="text-lg font-semibold text-gray-200 mb-2">ë²¡í„°í™”ëœ ì›ë³¸ í…ìŠ¤íŠ¸ (ì˜ˆì‹œ)</h4>
            <pre id="modal-source-text" class="mb-4"></pre>

            <h4 class="text-lg font-semibold text-gray-200 mb-2">768ì°¨ì› ê°€ìƒ ë²¡í„° (Virtual Vector)</h4>
            
            <!-- 1. ë²¡í„° ìŠ¤ë‹ˆí« (í…ìŠ¤íŠ¸) -->
            <p class="text-sm text-gray-400 mb-2">
                ì´ í…ìŠ¤íŠ¸ëŠ” 768ì°¨ì›ì˜ ìˆ«ì ë°°ì—´ë¡œ ë³€í™˜ë˜ì–´ ì €ì¥ë©ë‹ˆë‹¤.
            </p>
            <pre id="modal-vector-snippet" class="mb-4"></pre>

            <!-- 2. ê°€ìƒ ì‹œê°í™” (ë§‰ëŒ€ ê·¸ë˜í”„) -->
            <p class="text-sm text-gray-400 mb-2">
                768ê°œ ì°¨ì›ì´ ì¡°í•©ëœ ê³ ìœ ì˜ 'ì˜ë¯¸ ì§€ë¬¸' ê°€ìƒ ì‹œê°í™”
            </p>
            <div id="modal-vector-visual" class="mb-6">
                <!-- JSë¡œ 100+ê°œì˜ ë§‰ëŒ€(bar)ê°€ ì±„ì›Œì§‘ë‹ˆë‹¤ -->
            </div>
            
            <button id="modal-close" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition-colors">
                ë‹«ê¸°
            </button>
        </div>
    </div>

    <!-- 3D ì‹œê°í™” ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ -->
    <script type="module">
        // three.js ëª¨ë“ˆì—ì„œ í•„ìš”í•œ í´ë˜ìŠ¤ ì„í¬íŠ¸
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { CSS2DRenderer, CSS2DObject } from 'three/addons/renderers/CSS2DRenderer.js';

        let scene, camera, renderer, labelRenderer, controls;
        let canvasContainer, labelContainer;
        
        // --- ëª¨ë‹¬ UI ìš”ì†Œ ---
        let modal, modalTitle, modalSourceText, modalVectorSnippet, modalVectorVisual, modalClose;

        // --- íŠ¹í—ˆ ë°ì´í„° (ì˜ˆì‹œ) ---
        const patentData = {
            "íŠ¹í—ˆ A (EV ë°°í„°ë¦¬ ì¼€ì´ìŠ¤)": {
                text: "ë³¸ ë°œëª…ì€ ì „ê¸°ì°¨(EV) ë°°í„°ë¦¬ ì¼€ì´ìŠ¤ì— ê´€í•œ ê²ƒìœ¼ë¡œ, ë³µìˆ˜ì˜ ë°°í„°ë¦¬ ì…€ì„ ì™¸ë¶€ ì¶©ê²©ìœ¼ë¡œë¶€í„° ë³´í˜¸í•˜ê³ , íš¨ìœ¨ì ì¸ ì—´ ê´€ë¦¬ë¥¼ ì œê³µí•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•œë‹¤. ìƒê¸° ì¼€ì´ìŠ¤ëŠ” ê²½ëŸ‰ ê³ ê°•ë„ ë³µí•© ì†Œì¬ë¡œ ì œì¡°ë˜ë©°, ë‚´ë¶€ì— ëƒ‰ê° ì±„ë„ì„ í¬í•¨í•˜ëŠ” ê²ƒì„ íŠ¹ì§•ìœ¼ë¡œ í•œë‹¤.",
                vectorSeed: 0.1 // ì‹œê°í™” ìƒì„±ì„ ìœ„í•œ ì‹œë“œ ê°’ (ì‹œë®¬ë ˆì´ì…˜ìš©)
            },
            "íŠ¹í—ˆ A-1 (EV ë°°í„°ë¦¬ ê²½ëŸ‰í™”)": {
                text: "ë³¸ ë°œëª…ì€ ì „ê¸°ì°¨(EV) ë°°í„°ë¦¬ íŒ©ì˜ ê²½ëŸ‰í™” ê¸°ìˆ ì— ê´€í•œ ê²ƒì´ë‹¤. ê¸°ì¡´ ê¸ˆì† ì†Œì¬ ëŒ€ì‹  íƒ„ì†Œ ì„¬ìœ  ê°•í™” í”Œë¼ìŠ¤í‹±(CFRP)ì„ ì ìš©í•˜ì—¬ ë°°í„°ë¦¬ ì¼€ì´ìŠ¤ì˜ ì¤‘ëŸ‰ì„ íšê¸°ì ìœ¼ë¡œ ì¤„ì´ê³ , ë™ì‹œì— ì¶©ê²© í¡ìˆ˜ ì„±ëŠ¥ì„ í–¥ìƒì‹œì¼œ ì£¼í–‰ ê±°ë¦¬ ì¦ê°€ì— ê¸°ì—¬í•œë‹¤.",
                vectorSeed: 0.15 // Aì™€ ìœ ì‚¬í•œ ì‹œë“œ
            },
            "íŠ¹í—ˆ B (LNG í™”ë¬¼ì°½)": {
                text: "ë³¸ ë°œëª…ì€ ì•¡í™”ì²œì—°ê°€ìŠ¤(LNG) ìš´ë°˜ì„ ì˜ í™”ë¬¼ì°½ êµ¬ì¡°ì— ê´€í•œ ê²ƒì´ë‹¤. ê·¹ì €ì˜¨ì˜ LNGë¥¼ ì•ˆì „í•˜ê²Œ ì €ì¥í•˜ê¸° ìœ„í•œ ë©¤ë¸Œë ˆì¸ íƒ€ì… í™”ë¬¼ì°½ìœ¼ë¡œ, 2ì°¨ ë°©ë²½(Secondary Barrier)ì˜ ë‚´êµ¬ì„±ì„ í–¥ìƒì‹œí‚¤ê³  ë‹¨ì—´ ì„±ëŠ¥ì„ ê·¹ëŒ€í™”í•˜ëŠ” ìƒˆë¡œìš´ êµ¬ì¡°ë¥¼ ì œì•ˆí•œë‹¤.",
                vectorSeed: 0.8 // Aì™€ ë§¤ìš° ë‹¤ë¥¸ ì‹œë“œ
            },
            "íŠ¹í—ˆ B-1 (LNG 2ì°¨ë°©ë²½ ì†Œì¬)": {
                text: "ë³¸ ë°œëª…ì€ LNG í™”ë¬¼ì°½ì˜ 2ì°¨ ë°©ë²½ìš© ì‹ ê·œ ì†Œì¬ì— ê´€í•œ ê²ƒì´ë‹¤. ê¸°ì¡´ íŠ¸ë¼ì´í”Œë ‰ìŠ¤(Triplex) ì†Œì¬ ëŒ€ë¹„ ê·¹ì €ì˜¨ ì·¨ì„±(brittleness)ì´ ê°œì„ ë˜ê³ , ì‹œê³µì„±ì´ ìš°ìˆ˜í•œ í´ë¦¬ìš°ë ˆíƒ„ ê¸°ë°˜ ë³µí•© ì‹œíŠ¸ë¥¼ ê°œë°œí•˜ì—¬ í™”ë¬¼ì°½ì˜ ì•ˆì „ì„±ì„ ë†’ì¸ë‹¤.",
                vectorSeed: 0.85 // Bì™€ ìœ ì‚¬í•œ ì‹œë“œ
            }
        };

        function init() {
            // ìº”ë²„ìŠ¤, ë¼ë²¨, ëª¨ë‹¬ ì»¨í…Œì´ë„ˆ ê°€ì ¸ì˜¤ê¸°
            canvasContainer = document.getElementById('canvas-container');
            labelContainer = document.getElementById('label-container');
            
            // ëª¨ë‹¬ UI ìš”ì†Œ ì´ˆê¸°í™”
            modal = document.getElementById('modal');
            modalTitle = document.getElementById('modal-title');
            modalSourceText = document.getElementById('modal-source-text');
            modalVectorSnippet = document.getElementById('modal-vector-snippet');
            modalVectorVisual = document.getElementById('modal-vector-visual');
            modalClose = document.getElementById('modal-close');

            // 1. Scene (ì¥ë©´) ìƒì„±
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0c0c14);

            // 2. Camera (ì¹´ë©”ë¼) ìƒì„±
            const fov = 75, aspect = canvasContainer.clientWidth / canvasContainer.clientHeight, near = 0.1, far = 1000;
            camera = new THREE.PerspectiveCamera(fov, aspect, near, far);
            camera.position.set(60, 60, 60);

            // 3. Renderer (WebGL ë Œë”ëŸ¬) ìƒì„±
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(canvasContainer.clientWidth, canvasContainer.clientHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            canvasContainer.appendChild(renderer.domElement);

            // 4. Label Renderer (CSS2D ë Œë”ëŸ¬ - ë¼ë²¨ìš©) ìƒì„±
            labelRenderer = new CSS2DRenderer();
            labelRenderer.setSize(canvasContainer.clientWidth, canvasContainer.clientHeight);
            labelContainer.appendChild(labelRenderer.domElement);

            // 5. Controls (OrbitControls - ìƒí˜¸ì‘ìš©) ìƒì„±
            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.minDistance = 20;
            controls.maxDistance = 200;
            controls.target.set(0, 0, 0);

            // 6. Lights (ì¡°ëª…) ìƒì„±
            scene.add(new THREE.AmbientLight(0xffffff, 0.7));
            const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
            dirLight.position.set(1, 1, 1);
            scene.add(dirLight);

            // 7. Objects (ê°ì²´) ìƒì„±

            // "ì˜ë¯¸ ê³µê°„" ë°•ìŠ¤
            const spaceGeometry = new THREE.BoxGeometry(100, 100, 100);
            const spaceMaterial = new THREE.MeshBasicMaterial({ color: 0x444444, wireframe: true, transparent: true, opacity: 0.5 });
            scene.add(new THREE.Mesh(spaceGeometry, spaceMaterial));
            
            // ì¶• ë„ìš°ë¯¸
            scene.add(new THREE.AxesHelper(50));

            // ë²¡í„°(ì ) ì¬ì§ˆ
            const pointGeometry = new THREE.SphereGeometry(1, 16, 16);
            const materials = {
                title: new THREE.MeshStandardMaterial({ color: 0x007bff }),
                abstract: new THREE.MeshStandardMaterial({ color: 0x28a745 }),
                claims: new THREE.MeshStandardMaterial({ color: 0xdc3545 }),
                aiSummary: new THREE.MeshStandardMaterial({ color: 0xffc107 })
            };

            // í´ëŸ¬ìŠ¤í„° ìƒì„± í•¨ìˆ˜
            function createPatentCluster(basePosition, labelText) {
                const clusterGroup = new THREE.Group();
                clusterGroup.position.copy(basePosition);
                
                const offsets = [
                    new THREE.Vector3(1, 1, -1),   // Title
                    new THREE.Vector3(-1, 1, 1),  // Abstract
                    new THREE.Vector3(1, -1, 1),  // Claims
                    new THREE.Vector3(-1, -1, -1) // AI Summary
                ].map(v => v.multiplyScalar(1.5));

                // --- 4ê°œ í•„ë“œ ë²¡í„°(ì ) ìƒì„± (ì˜¤ë¥˜ ìˆ˜ì •ë¨) ---
                const mat = materials;
                const geo = pointGeometry;

                const titleVec = new THREE.Mesh(geo, mat.title);
                titleVec.position.set(offsets[0].x, offsets[0].y, offsets[0].z);
                clusterGroup.add(titleVec);

                const abstractVec = new THREE.Mesh(geo, mat.abstract);
                abstractVec.position.set(offsets[1].x, offsets[1].y, offsets[1].z);
                clusterGroup.add(abstractVec);

                const claimsVec = new THREE.Mesh(geo, mat.claims);
                claimsVec.position.set(offsets[2].x, offsets[2].y, offsets[2].z);
                clusterGroup.add(claimsVec);

                const aiSummaryVec = new THREE.Mesh(geo, mat.aiSummary);
                aiSummaryVec.position.set(offsets[3].x, offsets[3].y, offsets[3].z);
                clusterGroup.add(aiSummaryVec);
                
                scene.add(clusterGroup);
                // --- ìƒì„± ì™„ë£Œ ---

                // --- í´ëŸ¬ìŠ¤í„° ë¼ë²¨ ìƒì„± (CSS2DObject) ---
                const labelDiv = document.createElement('div');
                labelDiv.className = 'label';
                labelDiv.textContent = labelText;
                
                // ë¼ë²¨ í´ë¦­ ì‹œ ëª¨ë‹¬ì°½ í‘œì‹œ
                labelDiv.addEventListener('click', (e) => {
                    e.stopPropagation(); // 3D ìº”ë²„ìŠ¤ í´ë¦­ ë°©ì§€
                    showClusterModal(labelText);
                });

                const clusterLabel = new CSS2DObject(labelDiv);
                clusterLabel.position.copy(basePosition);
                clusterLabel.position.y += 8; // ì ë“¤ë³´ë‹¤ ì•½ê°„ ìœ„ì— ìœ„ì¹˜
                scene.add(clusterLabel);
            }

            // --- íŠ¹í—ˆ í´ëŸ¬ìŠ¤í„° ìƒì„± ---
            createPatentCluster(new THREE.Vector3(25, 25, 25), "íŠ¹í—ˆ A (EV ë°°í„°ë¦¬ ì¼€ì´ìŠ¤)");
            createPatentCluster(new THREE.Vector3(-25, -25, -25), "íŠ¹í—ˆ B (LNG í™”ë¬¼ì°½)");
            createPatentCluster(new THREE.Vector3(30, 28, 22), "íŠ¹í—ˆ A-1 (EV ë°°í„°ë¦¬ ê²½ëŸ‰í™”)");
            createPatentCluster(new THREE.Vector3(-30, -28, -22), "íŠ¹í—ˆ B-1 (LNG 2ì°¨ë°©ë²½ ì†Œì¬)");

            // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
            window.addEventListener('resize', onWindowResize);
            
            // ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼
            modalClose.addEventListener('click', () => {
                modal.classList.remove('visible');
                modal.classList.add('hidden');
            });
        }

        // --- ëª¨ë‹¬ì°½ í‘œì‹œ í•¨ìˆ˜ ---
        function showClusterModal(patentId) {
            const data = patentData[patentId];
            if (!data) return;

            // 1. ëª¨ë‹¬ í…ìŠ¤íŠ¸ ì±„ìš°ê¸°
            modalTitle.textContent = patentId;
            modalSourceText.textContent = data.text;

            // 2. ê°€ìƒ ë²¡í„° ì‹œê°í™” (ì‹œë®¬ë ˆì´ì…˜)
            
            // ê°€ì§œ ëœë¤ í•¨ìˆ˜ (ì‹œë“œë¥¼ ì‚¬ìš©í•´ ì¼ê´€ëœ íŒ¨í„´ ìƒì„±)
            let seed = data.vectorSeed * 1000;
            const randomWithSeed = (min = 0, max = 1) => {
                const a = 1664525, c = 1013904223, m = 2**32;
                seed = (a * seed + c) % m;
                return min + (seed / m) * (max - min); // min~max ì‚¬ì´ ê°’
            };
            
            // 2a. ë²¡í„° ìŠ¤ë‹ˆí« (í…ìŠ¤íŠ¸) ìƒì„±
            const snippetValues = [
                randomWithSeed(-1, 1).toFixed(4),
                randomWithSeed(-1, 1).toFixed(4),
                randomWithSeed(-1, 1).toFixed(4),
                randomWithSeed(-1, 1).toFixed(4)
            ];
            modalVectorSnippet.textContent = `Vector(768D) = [ ${snippetValues[0]}, ${snippetValues[1]}, ..., ${snippetValues[2]}, ${snippetValues[3]} ]`;

            // 2b. ê°€ìƒ ì‹œê°í™” (ë§‰ëŒ€ ê·¸ë˜í”„) ìƒì„±
            modalVectorVisual.innerHTML = ''; // ì´ì „ ë§‰ëŒ€ ì œê±°
            const numBars = 128; // 768ê°œë¥¼ ìƒì§•í•˜ëŠ” 128ê°œì˜ ë§‰ëŒ€

            for (let i = 0; i < numBars; i++) {
                const bar = document.createElement('div');
                bar.className = 'vector-bar';
                
                const value = randomWithSeed(5, 100); // 5% ~ 100% ë†’ì´
                bar.style.height = `${value}%`;

                // ì‹œë“œì— ë”°ë¼ ìƒ‰ìƒ ê³„ì—´ ë³€ê²½ (A, A-1ì€ ë…¹ìƒ‰ê³„ì—´, B, B-1ì€ íŒŒë€ê³„ì—´)
                const hue = (data.vectorSeed < 0.5) ? randomWithSeed(90, 150) : randomWithSeed(180, 240);
                bar.style.backgroundColor = `hsl(${hue}, 80%, 60%)`;
                
                modalVectorVisual.appendChild(bar);
            }

            // 3. ëª¨ë‹¬ ë³´ì´ê¸°
            modal.classList.remove('hidden');
            modal.classList.add('visible');
        }

        // ì°½ í¬ê¸° ì¡°ì ˆ ì²˜ë¦¬
        function onWindowResize() {
            if (!canvasContainer) return;
            const width = canvasContainer.clientWidth;
            const height = canvasContainer.clientHeight;

            camera.aspect = width / height;
            camera.updateProjectionMatrix();

            renderer.setSize(width, height);
            labelRenderer.setSize(width, height);
        }

        // ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„
        function animate() {
            requestAnimationFrame(animate);
            controls.update(); // ì»¨íŠ¸ë¡¤ ì—…ë°ì´íŠ¸
            renderer.render(scene, camera); // WebGL ë Œë”ë§
            labelRenderer.render(scene, camera); // CSS2D ë¼ë²¨ ë Œë”ë§
        }

        // ì´ˆê¸°í™” ë° ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
        init();
        animate();

    </script>
</body>
</html>